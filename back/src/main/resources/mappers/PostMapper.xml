<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gardener.PostMapper">
    <sql id="postColumns">
        id
        ,user_id, main_title, sub_title, content, main_title_img, category, post_public, favorite, create_post
    </sql>

    <insert id="insertPost" parameterType="Post">
        insert into post(<include refid="postColumns"></include>)
        values(post_seq.nextval, #{userId}, #{mainTitle}, #{subTitle}, #{content}, #{mainTitleImg},
        #{category}, 0, 0, systimestamp )
    </insert>

  	<!-- 상세정보 불러오기 -->
    <resultMap id="joinMap" type="Post" autoMapping="true">
        <id property="id" column="id"/>
        <result property="memberId" column="member_id"/>
        <result property="mainTitle" column="main_title"/>
        <result property="subTitle" column="sub_title"/>
        <result property="content" column="content"/>
        <result property="mainTitleImg" column="main_title_img"/>
        <result property="category" column="category"/>
        <result property="postPublic" column="post_public"/>
        <result property="favorite" column="favorite"/>
        <result property="createPost" column="create_post"/>
        <association property="member" javaType="Member" resultMap="memberResultMap" autoMapping="true"/>
    </resultMap>

    <resultMap id="memberResultMap" type="Member">
        <id property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="intro" column="intro"/>
        <result property="profile" column="profile"/>
    </resultMap>

    <select id="selectPost" parameterType="int" resultMap="joinMap">
        SELECT m.name,
               m.intro,
               m.profile,
               p.*
        from post p
                 JOIN member m
                      ON p.member_id = m.id
        WHERE p.id = #{id}
    </select>
    <!-- 상세정보 불러오기 -->
</mapper>